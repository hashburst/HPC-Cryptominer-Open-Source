[supervisord]
nodaemon=true
user=miner
logfile=/app/logs/supervisord.log
pidfile=/app/logs/supervisord.pid
childlogdir=/app/logs/

[unix_http_server]
file=/tmp/supervisor.sock
chmod=0700
chown=miner:miner

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

# Main mining engine
[program:mining_engine]
command=python3 /app/main.py --mode=mining
directory=/app
user=miner
autostart=true
autorestart=true
startsecs=10
startretries=3
stdout_logfile=/app/logs/mining_engine.log
stderr_logfile=/app/logs/mining_engine_error.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=5
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=5
environment=PYTHONPATH="/app",PYTHONUNBUFFERED="1"

# Cluster orchestrator
[program:orchestrator]
command=python3 /app/main.py --mode=orchestrator
directory=/app
user=miner
autostart=true
autorestart=true
startsecs=10
startretries=3
stdout_logfile=/app/logs/orchestrator.log
stderr_logfile=/app/logs/orchestrator_error.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=5
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=5
environment=PYTHONPATH="/app",PYTHONUNBUFFERED="1"

# Web dashboard (optional)
[program:dashboard]
command=python3 /app/main.py --mode=dashboard
directory=/app
user=miner
autostart=false
autorestart=true
startsecs=5
startretries=3
stdout_logfile=/app/logs/dashboard.log
stderr_logfile=/app/logs/dashboard_error.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=5
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=5
environment=PYTHONPATH="/app",PYTHONUNBUFFERED="1"

# Node agent (for cluster nodes)
[program:node_agent]
command=python3 /app/main.py --mode=node
directory=/app
user=miner
autostart=false
autorestart=true
startsecs=5
startretries=3
stdout_logfile=/app/logs/node_agent.log
stderr_logfile=/app/logs/node_agent_error.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=5
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=5
environment=PYTHONPATH="/app",PYTHONUNBUFFERED="1"

# Performance monitor
[program:monitor]
command=python3 /app/main.py --mode=monitor
directory=/app
user=miner
autostart=true
autorestart=true
startsecs=5
startretries=3
stdout_logfile=/app/logs/monitor.log
stderr_logfile=/app/logs/monitor_error.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=5
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=5
environment=PYTHONPATH="/app",PYTHONUNBUFFERED="1"